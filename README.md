# cloudDesk
云桌面产品

	1. 背景和价值
  
	2.  需求用例描述
  
	术语	含义
	超级管理员	缺省角色，系统缺省存在，唯一用户，具有所有功能的操作权限
	系统管理员	缺省角色，拥有如下权限：管理资源域（创删改查资源域，同步虚机）；查看虚机列表、状态，操作虚机开机，重启，关机，备份，恢复（可选重新初始化，选备份时间点虚机），对不存在的虚机可删除；总览管理域的虚机状态（开机、关机、异常、不存在）；系统管理（虚机组管理，将虚机列表分组；用户管理），安全管理（修改自身密码）
	虚机管理员	缺省角色，拥有如下权限：总览虚机组的虚机分配情况；查看虚机组的虚机列表，状态，分配和释放虚机给用户或用户组，
	监控员	     缺省角色，拥有指定组织内用户虚机的监控权限。
	虚机操作员	缺省角色，终端用户，拥有被分配虚机的开机，重启，关机，控制台操作权限。
	资源域	
	虚机组	
	用户组	
	VIM	虚机基础设施，包括openstack vmvare 公有云等
	

	2.1 登录
		
		○ 描述
		
		
		○ 原型
	
		○ 接口
		
	2.2 退出
		用户选择退出，系统删掉客户端缓存的用户名，角色及token信息，不与后端交互。
	2.3 总览
		○ 位置
		Dashboard/总览
		○ 描述
		针对不同的角色，展示不同角色虚机状态。
		适用角色：系统管理员、虚机管理员、超级管理员
		系统管理员	显示管理域内各个状态的虚机占用情况
		虚机管理员	显示虚机组内已分配和未分配的占有情况
		超级管理员	显示管理域内各个状态的虚机占用情况，虚机组内已分配和未分配的占有情况
		
	
		○ 原型
		饼状图
		○ 接口
		根据用户角色查询不同的虚机状态
		接口描述	操作	下发参数	返回参数
		系统管理员查询	Get		
			Get		
			Get		
		
	
	2.4 虚机工作台
		○ 位置
		 Dashboard/虚机工作台
		○ 描述
		针对不同角色，显示不同的列和操作集
		适用角色：超级管理员，系统管理员，虚机管理员，监控员，虚机操作员
		前置条件：用户登录系统
		正常过程：
		001 查询虚机列表
		001.1 用户进入虚机工作台
		001.2 系统按分页查询虚机列表，缺省每页10行，计算出总页数，并显示第一页，显示当前虚机相关信息，列名见虚机列字典。
		001.3 用户可选择查询条件（见数字字典查询条件部分），缺省查询条件为空，查询第一页；
		001.4 用户可点击下一页，或改变每页显示行数；
		001.5 用户继续选择相关操作；
		
		002 开机
		002.1 用户选择开机操作
		002.2 系统下发开机操作，状态显示启动中…
		002.3 系统启动完成后，状态变为运行（cometd框架，支持websocket）
		
		003 关机
		003.1 用户选择关机；
		003.2 状态显示关机中…;
		003.3 成功，状态显示关机；失败，转到异常过程；
		
		004 重启
		004.1 当前虚机关机时，用户选择重启；
		004.2 系统显示重启中，重启成功，状态为运行，失败，则转到异常过程；
		
		004 控制台
		004.1 用户选择控制台；
		004.2 系统弹出新的网页，成功进入操作系统登录页面，用户输入虚机用户名和密码。
		
		005 分配
		005.1 用户选择需要分配的虚机。
		005.2 点击分配，系统弹出对话框表格，第一列是选择的虚机，第二列是下拉框，用户选择组织下的角色是操作员的用户，一个虚机只能分配给一个用户，一个用户可以分配多个虚机。
		005.3 用户点击确定，成功则更新虚机列表中用户所属用户，用户组，分配状态等信息，失败，则转到异常过程；
		
		006 释放
		006.1 用户选择分配状态是已分配的一行或多行虚机；
		006.2 用户点击释放，系统弹出对话框提示确定释放，点击确定，则释放，取消，则退出；
		006.3 释放成功，则关闭对话框；失败，则转向异常过程；
		
		007 备份
		007.1 用户选择备份；
		007.2 备份成功后，系统提示成功，失败，则转到异常过程。
		
		008 恢复
		008.1 当虚机出现异常或其他原因，用户选择恢复虚机；
		008.2 系统弹出对话框，显示，恢复到初始设置，或恢复到备份时间的虚机；
		008.3 用户选择其中一项，点击确定，系统执行恢复，成功则提示恢复成功，失败，则转到异常过程；
		
		009 删除（只有系统管理员和超级管理员可执行）
		009.1 用户可对虚机状态为不一致的虚机，选择删除；
		009.2 系统成功删除管理域虚机；失败，转到异常过程；
		
		异常过程：
		101 token过期
		1011 过期后，用户点击任何功能都返回401错误，进入系统登录界面
		
		数字字典：
			(i) 超级管理员的工作台
			查询字段字典
			查询字段	说明
			虚机名	
			配置	
			虚机状态	
			分配状态	
			用户	
			用户组	
			所属资源域	
			所属虚机组	
			虚机列字典
			列名	说明
			虚机名	
			虚机ID	
			配置	高（8核16G200G），中，低
			虚机状态	运行，关机，重启中…，关机中…，启动中…，虚机不存在，异常
			所属资源域	
			所属虚机组	
			所属用户组	
			所属用户	
			分配状态	已分配，待分配
			操作	开机，关机，重启，控制台，备份，恢复
			(ii) 系统管理员工作台
			查询字段字典
			查询字段	说明
			虚机名	
			配置	
			虚机状态	
			分配状态	
			用户	
			用户组	
			所属资源域	
			虚机列字典
			列名	说明
			虚机名	
			虚机ID	
			配置	高（8核16G200G），中，低
			虚机状态	运行，关机，重启中…，关机中…，启动中…，虚机不存在，异常
			所属资源域	
			所属用户	
			分配状态	已分配，待分配
			操作	开机，关机，重启，控制台，备份，恢复
			
			(iii) 虚机管理员工作台
			查询字段字典
			查询字段	说明
			虚机名	
			配置	
			虚机状态	
			分配状态	
			用户	
			所属虚机组	
			虚机列字典
			列名	说明
			虚机名	
			虚机ID	
			配置	高（8核16G200G），中，低
			虚机状态	运行，关机，重启中…，关机中…，启动中…，虚机不存在，异常
			所属虚机组	
			所属用户	
			分配状态	已分配，待分配
			操作	开机，关机，重启，备份，恢复
			
			(iv) 终端操作员
			虚机列字典
			列名	说明
			虚机名	
			虚机ID	
			配置	高（8核16G200G），中，低
			虚机状态	运行，关机，重启中…，关机中…，启动中…，虚机不存在，异常
			操作	开机，关机，重启，控制台
		
		○ 原型
                
		○ 接口
		虚机列表支持分页查询
	2.5 虚机组
		○ 位置
		系统/虚机组
		○ 描述
	       虚机组是对管理域同步上来的虚机进行分组。
	       适用角色：虚机管理员，超级管理员；
	       前置条件：用户登录系统，已同步虚机且状态一致
	       正常过程：
	       001 查询虚机组
	       001.1 用户进入系统---虚机组；
	       001.2 系统查询系统已有虚机组（分页），显示列名，见数据字典；
	       
	      002 新建虚机组
	      
	      003 修改虚机组
	
	      004 删除虚机组
	      
	      异常过程：
	     
	      数据字典：
		○ 原型
	
		○ 接口
	
	
	2.6 用户组
		○ 位置
		系统/用户组
		○ 描述
	    
		○ 原型
	
		○ 接口
	
	
	2.7 用户
		○ 位置
		系统/用户
		○ 描述
    
		○ 原型

		○ 接口
	
	2.8 修改密码
		○ 位置
		安全/修改密码
		○ 描述
	    
		○ 原型
	
		○ 接口
	2.9 资源域管理
		○ 位置
		系统/资源域管理
		○ 描述
		    接入底层的vim系统，用户可以创建，删除，修改资源域，同步虚机到系统的资源域内，查询资源域内虚机的同步状态。
		适用角色：系统管理员，超级管理员
		前置条件：用户登录登录系统，并具有操作权限
		正常过程：
		001 查询资源域
		001.1用户进入系统--资源域管理，缺省查询已有资源域列表，见数字字段资源表格；
		001.2系统查询资源域并列到表格里。
		
		002 创建资源域
		002.1 用户选择新建资源域；
		002.2 系统弹出表单，见数字字典资源域表单；
		002.3 创建成功，表格新增一行，创建失败见异常过程；
		
		003 删除资源域
		003.1 用户可选择多列，选择删除
		003.2 系统提示是否确定删除资源域
		003.3 确定，则删除资源域，且同步删除关联虚机，更新用户，取消，则关闭对话框。
		
		004 修改资源域
		004.1 用户选择修改资源列，点击操作列的修改
		004.2 系统弹出修改表单，同创建资源域表单，区别是参数可修改，其他字段置灰；
		004.3 用户修改参数，点击确定，或取消；
		004.4 修改成功关闭表单，修改失败，见异常过程。
		
		005 同步虚机
		005.1 针对不一致状态资源域，用户选择操作列的同步操作；
		005.2 状态列，显示同步中…，同步完成后，显示一致，同步失败，见异常过程；
		
		006 查询状态
		006.1 用户可查询当前资源域和接入的vim中虚机的连接状态及一致状态；
		006.2 如果无法连接vim，则显示断开；连接，则判断一致性；
		
		异常过程：
		101 token过期
		
		数字字典：
		    创建资源域表单字段
			字段	说明
			资源域名	
			描述	
			VIM类型	
			参数	列表
		   资源域表格
			列名	说明
			资源域名	
			资源uuid	
			描述	
			VIM类型	Openstack vmvare …
			状态	断开，不一致，一致
			操作	修改（表单参数可修改，其他字段置灰），同步，查询状态
		○ 原型
	
		○ 接口
	
   

